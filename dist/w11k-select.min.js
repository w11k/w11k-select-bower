/**
 * @version v0.11.2
 * @link https://github.com/w11k/w11k-select
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("angular")):"function"==typeof define&&define.amd?define(["exports","angular"],t):t(e["w11k-select"]=e["w11k-select"]||{},e.angular)}(this,function(e,t){"use strict";
g.$inject = ["e", "r", "o", "l", "a", "p", "h", "g"];
w.$inject = ["e"];
b.$inject = ["e"];function n(e,t){for(var i=e.length;i--;)e[i].selected=t,e[i].state=t?C.selected:C.unselected,n(e[i].children||[],t)}function i(e){e.forEach(function(e){e.selected=e.isSearchResultOrParent,e.state=e.selected?C.selected:C.unselected,i(e.children||[])})}function r(e,t){var n={};return n[t.item]=e,t.value(n)}function o(e,t){return r(e.model,t)}function c(e,t,n){var i=[];return e.forEach(function(e){return l(e,i,t)}),i}function l(e,t,n){e.state===C.selected&&t.push(o(e,n)),e.children.forEach(function(e){return l(e,t,n)})}function s(e,t,n){if(void 0!==n.tracking){var i={},r=n.value.assign;r(i,e);var o=n.tracking(i);if(void 0===o)throw new Error("Couldn't get 'track by' value. Please make sure to only use something in 'track byâ€™ part of w11kSelectOptions expression, accessible from result of value part. ('option.data' and 'option.data.unique' but not 'option.unique')");return o.toString()}return t.hashCode(e)}function a(e,t){var n={};return n[t.item]=e,t.label(n)}function u(e,t,n,i,o){function c(e,t){var u=r(e,i),f=s(u,n,i),d=a(e,i),p=new D(f,d,e,!!l[f],l[f]?C.selected:C.unselected,[],t||null);return e[o.children]&&(p.children=e[o.children].map(function(e){return c(e,f)})),p}for(var l={},u=t.length;u--;){var f=s(t[u],n,i);l[f]=!0}return e.map(c)}function f(e,t){e.state===C.selected&&t.push(e.label),e.children.forEach(function(e){return f(e,t)})}function d(e,t){e.forEach(function(e){if(t[e.trackingId])throw new Error("Duplicate hash value for options "+e.label+" and "+t[e.trackingId].label);t[e.trackingId]=e,e.children&&d(e.children,t)})}function p(e){return!!e&&e.length>0}function h(e){return e.some(function(e){return e.isSearchResultOrParent||h(e.children)})}function g(e,r,o,l,a,p,h,g){"ngInject";var w=t.element(h);return{restrict:"A",replace:!1,templateUrl:e.common.templateUrl,scope:{},require:"ngModel",controller:["e", "t", "n", function(e,t,n){if(t.w11kSelect&&t.w11kSelect.length>0){var i=n(t.w11kSelect);i.assign&&i.assign(e.$parent,this)}this.open=function(){e.dropdown.open()},this.close=function(){e.dropdown.close()},this.toggle=function(){e.dropdown.toggle()}}],compile:function(a,m){var k=r(m.w11kSelectConfig),y=l.parseOptions(m.w11kSelectOptions),S=r(m.ngModel).assign,b=y.value.assign;if(void 0!==y.tracking&&void 0===b)throw new Error("value part of w11kSelectOptions expression must be assignable if 'track by' is used");return function(r,a,m,b){function $(){B.then(function(){O(),j(),v(r.config,F)}),W||(x(),W=!0)}function x(){if(r.config.filter.select.active&&null!==r.config.filter.select.text&&"undefined"!=typeof r.config.filter.select.text){var e=T.querySelector(".select-filtered-text");e.textContent=r.config.filter.select.text}if(r.config.filter.deselect.active&&null!==r.config.filter.deselect.text&&"undefined"!=typeof r.config.filter.deselect.text){var t=T.querySelector(".deselect-filtered-text");t.textContent=r.config.filter.deselect.text}if(null!==r.config.header.placeholder&&"undefined"!=typeof r.config.header.placeholder){var n=T.querySelector(".header-placeholder");n.textContent=r.config.header.placeholder}}function O(){if(r.config.multiple===!1){var e=L.filter(function(e){return e.state===C.selected});e.length>0&&(n(e,!1),e[0].state=C.selected)}}function I(e){27===e.keyCode&&r.dropdown.close&&r.dropdown.close()}function E(){if(t.isDefined(r.config.style.maxHeight))J.style.maxHeight=r.config.style.maxHeight;else{var e=P();J.style.maxHeight=e+"px"}}function D(){J.style.maxHeight=""}function P(){var e,n,i,o=J.getBoundingClientRect().top,c=h.innerHeight||h.document.documentElement.clientHeight;if(t.isDefined(G)?(n=G.innerHeight||G.clientHeight,i=G.getBoundingClientRect().top):(n=h.innerHeight||h.document.documentElement.clientHeight,i=0),r.config.style.marginBottom.indexOf("px")<0)throw new Error("Illegal Value for w11kSelectStyle.marginBottom");var l,s,a=parseFloat(r.config.style.marginBottom.slice(0,-2));n+i>c?(l=c,s=0):(l=n,s=i),e=l-(o-s)-a;var u=93;return e<u&&(e=u),e}function q(){if(t.isDefined(r.config.header.text))Q.textContent=r.$parent.$eval(r.config.header.text);else{var e=[];L.forEach(function(t){return f(t,e)}),Q.textContent=e.join(", ")}}function H(){_&&(K=A(L,r.filter.values.label?r.filter.values.label.toLowerCase():""),r.options.visible=K.slice(0,Y))}function F(){var t=c(L,y,e);b.$setViewValue(t),q()}function j(){var n=c(L,y,e);t.forEach(b.$parsers,function(e){n=e(n)}),S(r.$parent,n)}function M(){B.then(function(){Z=!0;var e=b.$viewValue;n(L,!1);for(var t=e.length;t--;){var i=s(e[t],l,y),r=N[i];r&&(r.state=C.selected)}q()})}function z(e){var n;return n=t.isArray(e)?e:t.isDefined(e)?[e]:[]}function R(e){if(!t.isUndefined(e)){var n;return n=r.config.multiple||r.config.forceArrayOutput?e:e[0]}}function V(e){if(r.config.required){if(r.config.multiple===!0&&0===e.length)return!1;if(r.config.multiple===!1&&r.config.forceArrayOutput===!0&&0===e.length)return!1;if(r.config.multiple===!1&&void 0===e)return!1}return!0}function U(){var e=b.$viewValue;return!(t.isArray(e)&&e.length>0)}var B,T=a[0],Z=!1,_=!1,L=[],N={},K=[];r.options={visible:[]},r.filter={values:{}},r.config=t.copy(e.instance);var W=!1;r.$watch(function(){return k(r.$parent)},function(e){t.isArray(e)?(l.extendDeep.apply(l,[r.config].concat(e)),$()):t.isObject(e)&&(l.extendDeep(r.config,e),$())},!0);var X=T.querySelector(".dropdown-menu"),J=T.querySelector(".dropdown-menu .content"),G=l.getParent(a,".w11k-select-adjust-height-to"),Q=T.querySelector(".header-text");r.dropdown={onOpen:function(e){return r.config.disabled?void e.prevent():(_===!1&&(_=!0),H(),o.on("keyup",I),X.style.visibility="hidden",p(function(){E(),X.style.visibility="visible",r.config.filter.active&&p(function(){a[0].querySelector(".dropdown-menu input").focus()})}),w.on("resize",E),void(t.isFunction(r.config.dropdown.onOpen)&&r.config.dropdown.onOpen()))},onClose:function(){r.filter.values.label="",p(function(){D()}),o.off("keyup",I),w.off("resize",E),t.isFunction(r.config.dropdown.onClose)&&r.config.dropdown.onClose()}},r.$on("$destroy",function(){o.off("keyup",I),w.off("resize",E)}),r.onKeyPressedOnDropDownToggle=function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),r.dropdown.toggle())};var Y=80,ee=.5*Y;r.showMoreOptions=function(){r.options.visible=K.slice(0,r.options.visible.length+ee)},r.onFilterValueChanged=function(){H()},r.clearFilter=function(){r.filter.values={},H()},r.onKeyPressedInFilter=function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),r.selectFiltered())},r.selectFiltered=function(e){t.isDefined(e)&&(e.preventDefault(),e.stopPropagation()),r.config.children?i(L):r.config.multiple?n(K,!0):1===K.length&&r.select(K[0]),F()},r.deselectFiltered=function(e){t.isDefined(e)&&(e.preventDefault(),e.stopPropagation()),n(K,!1),F()},r.deselectAll=function(e){t.isDefined(e)&&(e.preventDefault(),e.stopPropagation()),n(L,!1),F()};var te=function(){var e=g.defer();return B=e.promise,function(){var n=y.collection(r.$parent),i=b.$viewValue;t.isArray(n)&&(L=u(n,i,l,y,r.config),N={},d(L,N),H(),Z&&j(),e.resolve())}}();r.$watchCollection(function(){return y.collection(r.$parent)},function(e){t.isDefined(e)&&te()}),r.select=function(e){return r.config.multiple?void F():(n(L,!1),e.state=C.selected,F(),void r.dropdown.close())},r.isEmpty=U,b.$isEmpty=U,b.$render=M,b.$formatters.push(z),b.$validators.required=V,b.$parsers.push(R)}}}}function v(e,t){if(e.children&&!e.multiple)throw new Error("Multiple must be enabled when displaying hierarchically structure");e.children&&t()}function w(e){"ngInject";return{restrict:"A",replace:!1,templateUrl:e.common.templateUrlOptions,scope:{options:"=",parent:"=",select:"&"},require:"ngModel",controller:["e", function(e){e.$parent.childsMap&&e.$parent.addChild(e,e.parent),e.childsMap={},e.upwardsClick=function(t,n){var i=e.options.find(function(e){return e.trackingId===t.parent});if(0===n.selected&&0===n.childsSelected?y(i,C.unselected,e):n.selected===n.length?y(i,C.selected,e):y(i,C.childsSelected,e),e.$parent.upwardsClick){var r=k(e.options);e.$parent.upwardsClick(i,r)}},e.addChild=function(t,n){e.childsMap[n.trackingId]=t},e.onOptionStateClick=function(t,n){switch(n.state){case C.unselected:y(n,C.selected,e);break;case C.selected:y(n,C.unselected,e);break;case C.childsSelected:y(n,C.selected,e)}if(e.$parent.upwardsClick){var i=k(e.options);e.$parent.upwardsClick(n,i)}e.childsMap[n.trackingId].downWardstoggleAll(n.state)},e.downWardstoggleAll=function(t){e.options=m(e.options,t,e)},e.filterSearchResultsInView=function(e){return e.isSearchResultOrParent}}]}}function m(e,t,n){return e.map(function(e){return e.children=m(e.children,t,n),y(e,t,n),e})}function k(e){return e.reduce(function(e,t){return t.state===C.selected&&e.selected++,t.state===C.unselected&&e.unselected++,t.state===C.childsSelected&&e.childsSelected++,e},new P(e.length))}function y(e,t,n){e.state=t,n.select({option:e})}function S(){return{scope:{state:"="},bindToController:!0,controllerAs:"$ctrl",template:'<a class="w11k-checkbox" ng-class="$ctrl.getClass($ctrl.state)"></a>',restrict:"E",controller:q}}function b(e){"ngInject";return{link:function(t,n,i){var r=0,o=!0,c=!1,l=function(){u(!0)},s=n[0];if(1!==s.children.length)throw new Error("scroll container has to have exactly one child!");var a=s.children[0],u=function(e){var n=a.clientHeight-s.scrollTop,l=n<=s.clientHeight*(r+1);l&&o?e?t.$apply(function(){t.$eval(i.w11kSelectInfiniteScroll)}):t.$eval(i.w11kSelectInfiniteScroll):l&&(c=!0)};return i.$observe("w11kSelectInfiniteScrollDistance",function(e){r=parseFloat(e)}),i.$observe("w11kSelectInfiniteScrollDisabled",function(e){o=!e,o&&c&&(c=!1,u())}),n.on("scroll",l),t.$on("$destroy",function(){n.off("scroll",l)}),e(function(){i.w11kSelectInfiniteScrollImmediateCheck&&t.$eval(i.w11kSelectInfiniteScrollImmediateCheck)&&u()})}}}function $(){return function(e,t,n){t.bind("keydown",function(e){32===e.keyCode&&e.preventDefault()}),t.bind("keyup",function(t){32!==t.keyCode&&13!==t.keyCode||e.$apply(n.keyListener)})}}var C,x=function(){function e(){this.templateUrl="w11k-select.tpl.html",this.templateUrlOptions="w11k-select-option.tpl.html"}return e}(),O=function(){function e(){this.required=!1,this.hideCheckboxes=!1,this.multiple=!0,this.forceArrayOutput=!1,this.disabled=!1,this.header={placeholder:"",text:void 0},this.dropdown={onOpen:void 0,onClose:void 0},this.filter={active:!0,placeholder:"Filter",select:{active:!0,text:void 0},deselect:{active:!0,text:void 0}},this.style={marginBottom:"10px",maxHeight:void 0},this.showClearAlways=!1}return e}(),I=function(){function e(e,t){this.common=e||new x,this.instance=t||new O}return e}(),E=function(){
e.$inject = ["e", "t"];function e(e,t){"ngInject";this.$parse=e,this.$document=t,this.OPTIONS_EXP=/^([a-zA-Z][\w\.]*)(?:\s+as\s+([a-zA-Z][\w\.]*))?\s+for\s+(?:([a-zA-Z][\w]*))\s+in\s+([$_a-zA-Z][\w\.\(\)]*(?:\s+\|\s[a-zA-Z][\w\:_\{\}']*)*)(?:\s+track\sby\s+([a-zA-Z][\w\.]*))?$/}return e.prototype.extendDeep=function(e){for(var n=this,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];return t.forEach(i,function(i){i!==e&&t.forEach(i,function(t,i){e[i]&&e[i].constructor&&e[i].constructor===Object?n.extendDeep(e[i],t):e[i]=t})}),e},e.prototype.hashCode=function(e){var n;n="object"==typeof e?t.toJson(e):e.toString();for(var i=0,r=n.length,o=0;o<r;o++)i=n.charCodeAt(o)+(i<<6)+(i<<16)-i;return i.toString(36)},e.prototype.parseOptions=function(e){var t=e.match(this.OPTIONS_EXP);if(!t){var n='"item.value" [as "item.label"] for "item" in "collection [ | filter ] [track by item.value.unique]"';throw new Error("Expected options in form of '"+n+"' but got \""+e+'".')}var i={value:this.$parse(t[1]),label:this.$parse(t[2]||t[1]),item:t[3],collection:this.$parse(t[4])};return void 0!==t[5]&&(i.tracking=this.$parse(t[5])),i},e.prototype.getParent=function(e,n){if(t.isFunction(e.parents)){var i=e.parents(n);if(i.length>0)return i[0]}else{var r="MatchesSelector",o=["matches","matchesSelector","moz"+r,"webkit"+r,"ms"+r,"o"+r];for(var c in o){var l=o[c];if(t.isFunction(e[0][l])){for(var s=e[0].parentNode;s!==this.$document[0];){if(s[l](n))return s;s=s.parentNode}return}}}},e}();!function(e){e[e.unselected=0]="unselected",e[e.selected=1]="selected",e[e.childsSelected=2]="childsSelected"}(C||(C={}));var D=function(){function e(e,t,n,i,r,o,c){this.trackingId=e,this.label=t,this.model=n,this.selected=i,this.state=r,this.children=o,this.parent=c,this.isSearchResultOrParent=!0}return e}(),A=function(e,t){return e.map(function(e){return p(e.children)&&(e.children=A(e.children,t)),e.isSearchResultOrParent=e.label.toString().toLowerCase().includes(t)||h(e.children),e})},P=function(){function e(e){this.selected=0,this.unselected=0,this.childsSelected=0,this.length=e}return e}(),q=function(){function e(){}return e.prototype.getClass=function(e){return C[e]},e}(),H=t.module("w11k.select",["w11k.dropdownToggle","w11k.select.template"]);H.constant("w11kSelectConfig",new I).directive("w11kSelectInfiniteScroll",b).service("w11kSelectHelper",E).directive("w11kSelect",g).directive("w11kSelectOption",w).directive("w11kSelectCheckbox",S).directive("keyListener",$),e.module=H,e.Config=I,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=w11k-select.min.js.map
