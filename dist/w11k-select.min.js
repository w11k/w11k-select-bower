/**
 * @version v0.10.5
 * @link https://github.com/w11k/w11k-select
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("angular")):"function"==typeof define&&define.amd?define(["exports","angular"],t):t(e["w11k-select"]=e["w11k-select"]||{},e.angular)}(this,function(e,t){"use strict";
d.$inject = ["e", "i", "o", "c", "s", "d", "p", "h"];
p.$inject = ["e"];
m.$inject = ["e"];function n(e,t){for(var i=e.length;i--;)e[i].selected=t,e[i].state=t?y.selected:y.unselected,n(e[i].children||[],t)}function i(e,t){var n={};return n[t.item]=e,t.value(n)}function o(e,t){return i(e.model,t)}function r(e,t,n){var i=[];return e.forEach(function(e){return c(e,i,t)}),i}function c(e,t,n){e.state===y.selected&&t.push(o(e,n)),e.children.forEach(function(e){return c(e,t,n)})}function l(e,t,n){if(void 0!==n.tracking){var i={},o=n.value.assign;o(i,e);var r=n.tracking(i);if(void 0===r)throw new Error("Couldn't get 'track by' value. Please make sure to only use something in 'track byâ€™ part of w11kSelectOptions expression, accessible from result of value part. ('option.data' and 'option.data.unique' but not 'option.unique')");return r.toString()}return t.hashCode(e)}function s(e,t){var n={};return n[t.item]=e,t.label(n)}function a(e,t,n,o,r){function c(e,t){var u=i(e,o),f=l(u,n,o),d=s(e,o),p=new x(f,d,e,!!a[f],a[f]?y.selected:y.unselected,[],t||null);return e[r.children]&&(p.children=e[r.children].map(function(e){return c(e,f)})),p}for(var a={},u=t.length;u--;){var f=l(t[u],n,o);a[f]=!0}return e.map(c)}function u(e,t){e.state===y.selected&&t.push(e.label),e.children.forEach(function(e){return u(e,t)})}function f(e,t){e.forEach(function(e){if(t[e.trackingId])throw new Error("Duplicate hash value for options "+e.label+" and "+t[e.trackingId].label);t[e.trackingId]=e,e.children&&f(e.children,t)})}function d(e,i,o,c,s,d,p,h){"ngInject";var g=t.element(p);return{restrict:"A",replace:!1,templateUrl:e.common.templateUrl,scope:{},require:"ngModel",controller:["e", "t", "n", function(e,t,n){if(t.w11kSelect&&t.w11kSelect.length>0){var i=n(t.w11kSelect);i.assign&&i.assign(e.$parent,this)}this.open=function(){e.dropdown.open()},this.close=function(){e.dropdown.close()},this.toggle=function(){e.dropdown.toggle()}}],compile:function(v,w){var m=i(w.w11kSelectConfig),k=c.parseOptions(w.w11kSelectOptions),S=i(w.ngModel).assign,$=k.value.assign;if(void 0!==k.tracking&&void 0===$)throw new Error("value part of w11kSelectOptions expression must be assignable if 'track by' is used");return function(i,v,w,$){function b(){Y.then(function(){x(),F(),I(i.config,P)}),K||(C(),K=!0)}function C(){if(i.config.filter.select.active&&i.config.filter.select.text){var e=B.querySelector(".select-filtered-text");e.textContent=i.config.filter.select.text}if(i.config.filter.deselect.active&&i.config.filter.deselect.text){var t=B.querySelector(".deselect-filtered-text");t.textContent=i.config.filter.deselect.text}if(i.config.header.placeholder){var n=B.querySelector(".header-placeholder");n.textContent=i.config.header.placeholder}}function x(){if(i.config.multiple===!1){var e=Z.filter(function(e){return e.state===y.selected});e.length>0&&(n(e,!1),e[0].state=y.selected)}}function D(e){27===e.keyCode&&i.dropdown.close&&i.dropdown.close()}function E(){if(t.isDefined(i.config.style.maxHeight))R.style.maxHeight=i.style.maxHeight;else{var e=A();R.style.maxHeight=e+"px"}}function O(){R.style.maxHeight=""}function A(){var e,n,o,r=R.getBoundingClientRect().top,c=p.innerHeight||p.document.documentElement.clientHeight;if(t.isDefined(W)?(n=W.innerHeight||W.clientHeight,o=W.getBoundingClientRect().top):(n=p.innerHeight||p.document.documentElement.clientHeight,o=0),i.config.style.marginBottom.indexOf("px")<0)throw new Error("Illegal Value for w11kSelectStyle.marginBottom");var l,s,a=parseFloat(i.config.style.marginBottom.slice(0,-2));n+o>c?(l=c,s=0):(l=n,s=o),e=l-(r-s)-a;var u=93;return e<u&&(e=u),e}function q(){if(t.isDefined(i.config.header.text))X.textContent=i.$parent.$eval(i.config.header.text);else{var e=[];Z.forEach(function(t){return u(t,e)}),X.textContent=e.join(", ")}}function H(){T&&(N=J(Z,i.filter.values,!1),i.options.visible=N.slice(0,G))}function P(){var t=r(Z,k,e);$.$setViewValue(t),q()}function F(){var n=r(Z,k,e);t.forEach($.$parsers,function(e){n=e(n)}),S(i.$parent,n)}function j(){Y.then(function(){te=!0;var e=$.$viewValue;n(Z,!1);for(var t=e.length;t--;){var i=l(e[t],c,k),o=_[i];o&&(o.state=y.selected)}q()})}function M(e){var n;return n=t.isArray(e)?e:t.isDefined(e)?[e]:[]}function z(e){if(!t.isUndefined(e)){var n;return n=i.config.multiple?e:e[0]}}function U(e){return(i.config.multiple!==!0||i.config.required!==!0||0!==e.length)&&(i.config.multiple!==!1||i.config.required!==!0||void 0!==e)}function V(){var e=$.$viewValue;return!(t.isArray(e)&&e.length>0)}var B=v[0],T=!1,Z=[],_={},N=[];i.options={visible:[]},i.filter={values:{}},i.config=t.copy(e.instance);var K=!1;i.$watch(function(){return m(i.$parent)},function(e){t.isArray(e)?(c.extendDeep.apply(null,[i.config].concat(e)),b()):t.isObject(e)&&(c.extendDeep(i.config,e),b())},!0);var L=B.querySelector(".dropdown-menu"),R=B.querySelector(".dropdown-menu .content"),W=c.getParent(v,".w11k-select-adjust-height-to"),X=B.querySelector(".header-text");i.dropdown={onOpen:function(e){return i.config.disabled?void e.prevent():(T===!1&&(T=!0),H(),o.on("keyup",D),L.style.visibility="hidden",d(function(){E(),L.style.visibility="visible",i.config.filter.active&&d(function(){v[0].querySelector(".dropdown-menu input").focus()})}),g.on("resize",E),void(t.isFunction(i.config.dropdown.onOpen)&&i.config.dropdown.onOpen()))},onClose:function(){i.filter.values.label="",d(function(){O()}),o.off("keyup",D),g.off("resize",E),t.isFunction(i.config.dropdown.onClose)&&i.config.dropdown.onClose()}},i.$on("$destroy",function(){o.off("keyup",D),g.off("resize",E)}),i.onKeyPressedOnDropDownToggle=function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),i.dropdown.toggle())};var J=s("filter"),G=80,Q=.5*G;i.showMoreOptions=function(){i.options.visible=N.slice(0,i.options.visible.length+Q)},i.onFilterValueChanged=function(){H()},i.clearFilter=function(){i.filter.values={},H()},i.onKeyPressedInFilter=function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),i.selectFiltered())},i.selectFiltered=function(e){t.isDefined(e)&&(e.preventDefault(),e.stopPropagation()),i.config.multiple?n(N,!0):1===N.length&&i.select(N[0]),P()},i.deselectFiltered=function(e){t.isDefined(e)&&(e.preventDefault(),e.stopPropagation()),n(N,!1),P()},i.deselectAll=function(e){t.isDefined(e)&&(e.preventDefault(),e.stopPropagation()),n(Z,!1),P()};var Y,ee=function(){var e=h.defer();return Y=e.promise,function(){var n=k.collection(i.$parent),o=$.$viewValue;t.isArray(n)&&(Z=a(n,o,c,k,i.config),_={},f(Z,_),H(),te&&F(),e.resolve())}}();i.$watchCollection(function(){return k.collection(i.$parent)},function(e){t.isDefined(e)&&ee()}),i.select=function(e){return i.config.multiple?void P():(n(Z,!1),e.state=y.selected,P(),void i.dropdown.close())};var te;i.isEmpty=V,$.$isEmpty=V,$.$render=j,$.$formatters.push(M),$.$validators.required=U,$.$parsers.push(z)}}}}function p(e){"ngInject";return{restrict:"A",replace:!1,templateUrl:e.common.templateUrlOptions,scope:{options:"=",parent:"=",select:"&"},require:"ngModel",controller:["e", "t", "n", function(e,t,n){e.$parent.childsMap&&e.$parent.addChild(e,e.parent),e.childsMap={},e.upwardsClick=function(t,n){var i=e.options.find(function(e){return e.trackingId===t.parent});if(0===n.selected&&0===n.childsSelected?v(i,y.unselected,e):n.selected===n.length?v(i,y.selected,e):v(i,y.childsSelected,e),e.$parent.upwardsClick){var o=g(e.options);e.$parent.upwardsClick(i,o)}},e.addChild=function(t,n){e.childsMap[n.trackingId]=t},e.onOptionStateClick=function(t,n){switch(n.state){case y.unselected:v(n,y.selected,e);break;case y.selected:v(n,y.unselected,e);break;case y.childsSelected:v(n,y.selected,e)}if(e.$parent.upwardsClick){var i=g(e.options);e.$parent.upwardsClick(n,i)}e.childsMap[n.trackingId].downWardstoggleAll(n.state)},e.downWardstoggleAll=function(t){e.options=h(e.options,t,e)}}]}}function h(e,t,n){return e.map(function(e){return e.children=h(e.children,t,n),v(e,t,n),e})}function g(e){return e.reduce(function(e,t){return t.state===y.selected&&e.selected++,t.state===y.unselected&&e.unselected++,t.state===y.childsSelected&&e.childsSelected++,e},new D(e.length))}function v(e,t,n){e.state=t,n.select({option:e})}function w(){return{scope:{state:"="},bindToController:!0,controllerAs:"$ctrl",template:'<a class="w11k-checkbox" ng-class="$ctrl.getClass($ctrl.state)"></a>',restrict:"E",controller:E}}function m(e){"ngInject";return{link:function(t,n,i){var o=0,r=!0,c=!1,l=function(){u(!0)},s=n[0];if(1!==s.children.length)throw new Error("scroll container has to have exactly one child!");var a=s.children[0],u=function(e){var n=a.clientHeight-s.scrollTop,l=n<=s.clientHeight*(o+1);l&&r?e?t.$apply(function(){t.$eval(i.w11kSelectInfiniteScroll)}):t.$eval(i.w11kSelectInfiniteScroll):l&&(c=!0)};return i.$observe("w11kSelectInfiniteScrollDistance",function(e){o=parseFloat(e)}),i.$observe("w11kSelectInfiniteScrollDisabled",function(e){r=!e,r&&c&&(c=!1,u())}),n.on("scroll",l),t.$on("$destroy",function(){n.off("scroll",l)}),e(function(){i.w11kSelectInfiniteScrollImmediateCheck&&t.$eval(i.w11kSelectInfiniteScrollImmediateCheck)&&u()})}}}function k(){return function(e,t,n){t.bind("keydown",function(e){32===e.keyCode&&e.preventDefault()}),t.bind("keyup",function(t){32!==t.keyCode&&13!==t.keyCode||e.$apply(n.keyListener)})}}var y,S=function(){function e(){this.templateUrl="w11k-select.tpl.html",this.templateUrlOptions="w11k-select-option.tpl.html"}return e}(),$=function(){function e(){this.required=!1,this.hideCheckboxes=!1,this.multiple=!0,this.disabled=!1,this.header={placeholder:"",text:void 0},this.dropdown={onOpen:void 0,onClose:void 0},this.filter={active:!0,placeholder:"Filter",select:{active:!0,text:void 0},deselect:{active:!0,text:void 0}},this.style={marginBottom:"10px",maxHeight:void 0},this.showClearAlways=!1}return e}(),b=function(){function e(e,t){this.common=e||new S,this.instance=t||new $}return e}(),C=function(){
e.$inject = ["e", "n"];function e(e,n){"ngInject";var i=this;this.$parse=e,this.$document=n,this.OPTIONS_EXP=/^([a-zA-Z][\w\.]*)(?:\s+as\s+([a-zA-Z][\w\.]*))?\s+for\s+(?:([a-zA-Z][\w]*))\s+in\s+([$_a-zA-Z][\w\.\(\)]*(?:\s+\|\s[a-zA-Z][\w\:_\{\}']*)*)(?:\s+track\sby\s+([a-zA-Z][\w\.]*))?$/,this.extendDeep=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return t.forEach(n,function(n){n!==e&&t.forEach(n,function(t,n){e[n]&&e[n].constructor&&e[n].constructor===Object?i.extendDeep(e[n],t):e[n]=t})}),e}}return e.prototype.hashCode=function(e){var n;n="object"==typeof e?t.toJson(e):e.toString();for(var i=0,o=n.length,r=0;r<o;r++)i=n.charCodeAt(r)+(i<<6)+(i<<16)-i;return i.toString(36)},e.prototype.parseOptions=function(e){var t=e.match(this.OPTIONS_EXP);if(!t){var n='"item.value" [as "item.label"] for "item" in "collection [ | filter ] [track by item.value.unique]"';throw new Error("Expected options in form of '"+n+"' but got \""+e+'".')}var i={value:this.$parse(t[1]),label:this.$parse(t[2]||t[1]),item:t[3],collection:this.$parse(t[4])};return void 0!==t[5]&&(i.tracking=this.$parse(t[5])),i},e.prototype.getParent=function(e,n){if(t.isFunction(e.parents)){var i=e.parents(n);if(i.length>0)return i[0]}else{var o="MatchesSelector",r=["matches","matchesSelector","moz"+o,"webkit"+o,"ms"+o,"o"+o];for(var c in r){var l=r[c];if(t.isFunction(e[0][l])){for(var s=e[0].parentNode;s!==this.$document[0];){if(s[l](n))return s;s=s.parentNode}return}}}},e}();!function(e){e[e.unselected=0]="unselected",e[e.selected=1]="selected",e[e.childsSelected=2]="childsSelected"}(y||(y={}));var x=function(){function e(e,t,n,i,o,r,c){this.trackingId=e,this.label=t,this.model=n,this.selected=i,this.state=o,this.children=r,this.parent=c}return e}(),I=function(e,t){if(e.children&&!e.multiple)throw new Error("Multiple must be enabled when displaying hierarchically structure");e.children&&t()},D=function(){function e(e){this.selected=0,this.unselected=0,this.childsSelected=0,this.length=e}return e}(),E=function(){function e(){}return e.prototype.getClass=function(e){return y[e]},e}(),O=t.module("w11k.select",["w11k.dropdownToggle","w11k.select.template"]);O.constant("w11kSelectConfig",new b).directive("w11kSelectInfiniteScroll",m).service("w11kSelectHelper",C).directive("w11kSelect",d).directive("w11kSelectOption",p).directive("w11kSelectCheckbox",w).directive("keyListener",k),e.module=O,e.Config=b,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=w11k-select.min.js.map
